<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Escalas de satisfacci√≥n ‚Äì Fundaci√≥n APASCOVI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Icono pesta√±a / app -->
    <link rel="icon" type="image/png" href="icono.png">
    <link rel="apple-touch-icon" href="icono.png">
    <meta name="theme-color" content="#063c7a">

    <!-- Librer√≠a para generar PDF (YA NO SE USA, PERO PUEDES DEJARLA O QUITARLA) -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script> -->

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
            background: #edf1fb;
            color: #222;
        }

        #survey {
            max-width: 1000px;
            margin: 0 auto 40px;
            background: #ffffff;
            padding: 16px 16px 32px;
            border-radius: 18px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.06);
        }

        header {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
            border-bottom: 3px solid #e0e6ff;
            padding-bottom: 12px;
            margin-bottom: 10px;
        }

        header img.logo {
            width: 90px;
            height: auto;
        }

        header .titles {
            flex: 1;
            min-width: 220px;
        }

        header .titles h1 {
            margin: 0;
            font-size: 1.6rem;
            color: #063c7a;
        }

        header .titles h2 {
            margin: 4px 0 2px;
            font-size: 1.1rem;
            color: #0a61b8;
        }

        header .titles p {
            margin: 2px 0;
            font-size: 0.95rem;
        }

        header .titles p.note {
            font-size: 0.85rem;
            font-style: italic;
            color: #555;
        }

        .participant-data {
            margin-top: 8px;
            padding: 10px 10px 2px;
            border-radius: 12px;
            background: #f5f7ff;
            border: 1px solid #dde2ff;
        }

        .participant-data h3 {
            margin: 0 0 8px;
            font-size: 1rem;
            color: #063c7a;
        }

        .participant-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 10px 14px;
        }

        .participant-grid label {
            font-size: 0.86rem;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .participant-grid input,
        .participant-grid select {
            padding: 6px 8px;
            border-radius: 8px;
            border: 1px solid #c4cae8;
            font-size: 0.9rem;
        }

        .hint {
            font-size: 0.8rem;
            font-weight: 400;
            color: #555;
            margin-top: 2px;
        }

        .instructions {
            margin-top: 12px;
            padding: 10px 10px 6px;
            border-radius: 12px;
            background: #fffaf0;
            border: 1px solid #ffe0b2;
            font-size: 0.92rem;
        }

        .instructions ul {
            margin: 4px 0 0 18px;
            padding: 0;
        }

        .instructions li {
            margin-bottom: 4px;
        }

        .section-title {
            margin-top: 20px;
            margin-bottom: 4px;
            font-size: 1.05rem;
            font-weight: 700;
            color: #063c7a;
        }

        .question {
            margin: 22px 0 18px;
            padding: 14px 10px;
            border-radius: 14px;
            background: #f6f8ff;
            border: 1px solid #d9dff5;
        }

        .pictos {
            display: flex;
            justify-content: center;
            gap: 14px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .pictos img {
            width: 110px;
            height: auto;
            border-radius: 10px;
            border: 2px solid #3b3f50;
            object-fit: contain;
            background: #ffffff;
        }

        .question-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .question-text {
            margin: 0;
            font-size: 1.05rem;
            font-weight: 600;
            flex: 1;
            min-width: 220px;
        }

        .question-text .q-number {
            margin-right: 4px;
        }

        .audio-btn {
            border: none;
            border-radius: 999px;
            padding: 6px 10px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #e0ecff;
            color: #063c7a;
            cursor: pointer;
            white-space: nowrap;
        }

        .audio-btn span.icon {
            font-size: 1.1rem;
        }

        .options {
            display: flex;
            justify-content: space-evenly;
            align-items: stretch;
            gap: 14px;
            flex-wrap: wrap;
        }

        .face-option {
            width: 110px;
            height: 110px;
            border-radius: 50%;
            border: 4px solid transparent;
            background: #ffffff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s ease;
        }

        .face-option .face-circle {
            font-size: 2.4rem;
            margin-bottom: 4px;
        }

        .face-option .face-label {
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .face-option.no .face-circle {
            color: #f57c00;
        }

        .face-option.sometimes .face-circle {
            color: #fbc02d;
        }

        .face-option.yes .face-circle {
            color: #7cb342;
        }

        .face-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 14px rgba(0,0,0,0.12);
        }

        .face-option.selected {
            border-color: #e53935; /* borde rojo cuando se selecciona */
            box-shadow: 0 0 0 4px rgba(229,57,53,0.18);
        }

        /* Pregunta 18 ‚Äì selecci√≥n m√∫ltiple */
        .multi-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 16px;
            margin-top: 6px;
        }

        .multi-option {
            width: 140px;
            border-radius: 14px;
            border: 3px solid transparent;
            background: #ffffff;
            padding: 8px 6px 10px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            transition: transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s ease;
        }

        .multi-option img {
            width: 110px;
            height: auto;
            border-radius: 10px;
            border: 2px solid #3b3f50;
            background: #ffffff;
            object-fit: contain;
            margin-bottom: 4px;
        }

        .multi-option .multi-label {
            font-size: 0.85rem;
            font-weight: 700;
            text-align: center;
        }

        .multi-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 14px rgba(0,0,0,0.12);
        }

        .multi-option.selected {
            border-color: #e53935;
            box-shadow: 0 0 0 3px rgba(229,57,53,0.2);
        }

        .help-text {
            margin: 8px 4px 0;
            font-size: 0.88rem;
            color: #555;
        }

        .download-buttons {
            margin-top: 26px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
        }

        .download-btn {
            border: none;
            border-radius: 999px;
            padding: 10px 22px;
            min-width: 220px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            color: #ffffff;
        }

        .download-btn.pdf {
            background-color: #d32f2f; /* rojo */
        }

        .download-btn.csv {
            background-color: #1976d2; /* azul */
        }

        @media (max-width: 600px) {
            .pictos img {
                width: 90px;
            }
            .face-option {
                width: 100px;
                height: 100px;
            }
            .multi-option {
                width: 130px;
            }
            header img.logo {
                width: 70px;
            }
        }

        @media print {
            .download-buttons {
                display: none;
            }
            .audio-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
<main id="survey">

    <!-- CABECERA -->
    <header>
        <img src="img/logo.png" alt="Logo Fundaci√≥n APASCOVI" class="logo">
        <div class="titles">
            <h1>Fundaci√≥n APASCOVI</h1>
            <h2>Tu satisfacci√≥n nos importa</h2>
            <p><strong>Escalas de valoraci√≥n de la satisfacci√≥n para los centros de atenci√≥n diurna.</strong></p>
            <p class="note"><em>(*) Conforme a RESOLUCI√ìN 4258/2025, de 1 de octubre, de la Direcci√≥n General de Evaluaci√≥n, Calidad e Innovaci√≥n.</em></p>
            <p>Lee las preguntas con calma, mira los pictogramas y elige la respuesta que mejor se ajusta a lo que piensas.</p>
        </div>
    </header>

    <!-- DATOS INICIALES -->
    <section class="participant-data">
        <h3>Datos del centro y de la persona</h3>
        <div class="participant-grid">
            <label>Nombre del centro
                <select id="campo-centro">
                    <option value="">Selecciona una opci√≥n‚Ä¶</option>
                    <option value="CENTRO DE D√çA">CENTRO DE D√çA</option>
                    <option value="COFOIL VILLALBA">COFOIL VILLALBA</option>
                    <option value="COFOIL COLMENAREJO">COFOIL COLMENAREJO</option>
                </select>
            </label>
            <label>Fecha
                <input type="date" id="campo-fecha">
            </label>
            <label>C√≥digo persona usuaria
                <input type="text" id="campo-codigo" placeholder="Ej.: A123">
            </label>
            <label>A√±os que llevas en el centro
                <select id="campo-antig-anios">
                    <!-- 0 a 40 -->
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                    <option value="32">32</option>
                    <option value="33">33</option>
                    <option value="34">34</option>
                    <option value="35">35</option>
                    <option value="36">36</option>
                    <option value="37">37</option>
                    <option value="38">38</option>
                    <option value="39">39</option>
                    <option value="40">40</option>
                </select>
            </label>
            <label>Meses que llevas en el centro
                <select id="campo-antig-meses">
                    <!-- 0 a 11 -->
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                </select>
                <span class="hint">Si has contestado 0 a√±os, indica aqu√≠ cu√°ntos meses llevas.</span>
            </label>
            <label>Profesional de apoyo
                <input type="text" id="campo-profesional" placeholder="Nombre del profesional que acompa√±a">
            </label>
        </div>
    </section>

    <section class="instructions">
        <strong>Instrucciones:</strong>
        <ul>
            <li>Puedes escuchar cada pregunta pulsando el bot√≥n <strong>Escuchar</strong>.</li>
            <li>Elige una carita: <strong>NO</strong>, <strong>A VECES</strong> o <strong>S√ç</strong>.</li>
            <li>En la √∫ltima pregunta marca exactamente <strong>3 cosas</strong> que te gustar√≠a mejorar en el centro.</li>
        </ul>
    </section>

    <!-- BLOQUE 1 -->
    <p class="section-title">ENTORNO F√çSICO: LAS INSTALACIONES DEL CENTRO Y SU ENTORNO</p>

    <!-- P1 -->
    <section class="question" data-question-id="q1">
        <div class="pictos">
            <img src="img/1.a.png" alt="Sal√≥n y muebles">
            <img src="img/1.b.png" alt="Comedor y mesas">
            <img src="img/1.c.png" alt="Persona sentada viendo la tele">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">1.</span>
                <span class="q-text">¬øLas zonas comunes y muebles que hay en tu centro son c√≥modos?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øLas zonas comunes y muebles que hay en tu centro son c√≥modos?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P2 -->
    <section class="question" data-question-id="q2">
        <div class="pictos">
            <img src="img/2.a.png" alt="Persona caminando">
            <img src="img/2.b.png" alt="Persona tropezando con obst√°culo">
            <img src="img/2.c.png" alt="Zona con juguetes u obst√°culos en el suelo">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">2.</span>
                <span class="q-text">¬øTe puedes mover por tu centro de forma f√°cil y sin obst√°culos?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe puedes mover por tu centro de forma f√°cil y sin obst√°culos?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P3 -->
    <section class="question" data-question-id="q3">
        <div class="pictos">
            <img src="img/3.a.png" alt="Productos de limpieza">
            <img src="img/3.b.png" alt="Persona limpiando">
            <img src="img/3.c.png" alt="Tareas de limpieza en habitaciones">
            <img src="img/3.d.png" alt="Mantenimiento del centro">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">3.</span>
                <span class="q-text">¬øTe gusta c√≥mo limpian y cuidan el centro?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe gusta c√≥mo limpian y cuidan el centro?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P4 -->
    <section class="question" data-question-id="q4">
        <div class="pictos">
            <img src="img/4.a.png" alt="Rampa accesible en la puerta">
            <img src="img/4.b.png" alt="Persona en silla de ruedas en el transporte">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">4.</span>
                <span class="q-text">¬øEl transporte para ir al centro y volver a casa es c√≥modo y adecuado para ti?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øEl transporte para ir al centro y volver a casa es c√≥modo y adecuado para ti?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- BLOQUE 2 -->
    <p class="section-title">ATENCI√ìN Y CUIDADOS QUE RECIBES</p>

    <!-- P5 -->
    <section class="question" data-question-id="q5">
        <div class="pictos">
            <img src="img/5.a.png" alt="Pedir ayuda">
            <img src="img/5.b.png" alt="Dolor o malestar">
            <img src="img/5.c.png" alt="Ca√≠da o problema">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">5.</span>
                <span class="q-text">¬øCuando tienes un problema, los profesionales del centro te atienden r√°pido?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øCuando tienes un problema, los profesionales del centro te atienden r√°pido?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P6 -->
    <section class="question" data-question-id="q6">
        <div class="pictos">
            <img src="img/6.a.png" alt="Necesidad de ayuda">
            <img src="img/6.b.png" alt="Cuidados de salud">
            <img src="img/6.c.png" alt="Profesional escuchando">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">6.</span>
                <span class="q-text">¬øLa atenci√≥n y los cuidados que recibes cubren bien tus necesidades?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øLa atenci√≥n y los cuidados que recibes cubren bien tus necesidades?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P7 -->
    <section class="question" data-question-id="q7">
        <div class="pictos">
            <img src="img/7.a.png" alt="Comida variada">
            <img src="img/7.b.png" alt="Bebida">
            <img src="img/7.c.png" alt="Comida servida en la mesa">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">7.</span>
                <span class="q-text">¬øTe gusta la comida y la bebida del centro (su sabor, cantidad y variedad)?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe gusta la comida y la bebida del centro, su sabor, cantidad y variedad?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P8 -->
    <section class="question" data-question-id="q8">
        <div class="pictos">
            <img src="img/8.a.png" alt="Productos de higiene personal">
            <img src="img/8.b.png" alt="Peluquer√≠a">
            <img src="img/8.c.png" alt="Corte de u√±as">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">8.</span>
                <span class="q-text">¬øTe gusta c√≥mo te ayudan con tu higiene personal?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe gusta c√≥mo te ayudan con tu higiene personal?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P9 -->
    <section class="question" data-question-id="q9">
        <div class="pictos">
            <img src="img/9.a.png" alt="Profesionales del centro">
            <img src="img/9.b.png" alt="Profesional atendiendo en despacho">
            <img src="img/9.c.png" alt="Profesional dando de comer">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">9.</span>
                <span class="q-text">¬øLas personas que te atienden en el centro saben hacer bien su trabajo?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øLas personas que te atienden en el centro saben hacer bien su trabajo?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- BLOQUE 3 -->
    <p class="section-title">RELACIONES, PARTICIPACI√ìN Y VIDA EN EL CENTRO</p>

    <!-- P10 -->
    <section class="question" data-question-id="q10">
        <div class="pictos">
            <img src="img/10.a.png" alt="Personas hablando en grupo">
            <img src="img/10.b.png" alt="Personas reunidas, incluida silla de ruedas">
            <img src="img/10.c.png" alt="Personas conversando de pie">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">10.</span>
                <span class="q-text">¬øTienes oportunidades para compartir momentos con otras personas del centro?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTienes oportunidades para compartir momentos con otras personas del centro?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P11 -->
    <section class="question" data-question-id="q11">
        <div class="pictos">
            <img src="img/11.a.png" alt="Abrazo">
            <img src="img/11.b.png" alt="Videollamada">
            <img src="img/11.c.png" alt="Persona hablando con otra">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">11.</span>
                <span class="q-text">¬øEl centro te ayuda a hablar o a estar en contacto con tu familia y amistades?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øEl centro te ayuda a hablar o a estar en contacto con tu familia y amistades?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P12 -->
    <section class="question" data-question-id="q12">
        <div class="pictos">
            <img src="img/12.a.png" alt="Calendario">
            <img src="img/12.b.png" alt="Persona escribiendo en la mesa">
            <img src="img/12.c.png" alt="Reloj">
            <img src="img/12.d.png" alt="Elegir entre opciones">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">12.</span>
                <span class="q-text">¬øPuedes participar en decisiones importantes como los horarios, la comida y las actividades del centro?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øPuedes participar en decisiones importantes como los horarios, la comida y las actividades del centro?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P13 -->
    <section class="question" data-question-id="q13">
        <div class="pictos">
            <img src="img/13.a.png" alt="Profesional acompa√±ando a persona en silla de ruedas">
            <img src="img/13.b.png" alt="Dar algo a otra persona">
            <img src="img/13.c.png" alt="Dar la mano">
            <img src="img/13.d.png" alt="Trato amable y apoyo">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">13.</span>
                <span class="q-text">¬øLos profesionales de tu centro son amables y te tratan con respeto?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øLos profesionales de tu centro son amables y te tratan con respeto?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P14 -->
    <section class="question" data-question-id="q14">
        <div class="pictos">
            <img src="img/14.a.png" alt="Actividad de jardiner√≠a">
            <img src="img/14.b.png" alt="Personas haciendo actividad en mesa">
            <img src="img/14.c.png" alt="Lectura y manualidades">
            <img src="img/14.d.png" alt="Bingo u otras actividades de ocio">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">14.</span>
                <span class="q-text">¬øTe gustan las actividades y el entretenimiento que hay en el centro durante el d√≠a?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe gustan las actividades y el entretenimiento que hay en el centro durante el d√≠a?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P15 -->
    <section class="question" data-question-id="q15">
        <div class="pictos">
            <img src="img/15.a.png" alt="Persona con intimidad">
            <img src="img/15.b.png" alt="Llamar antes de entrar">
            <img src="img/15.c.png" alt="Respeto a la privacidad">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">15.</span>
                <span class="q-text">¬øLos profesionales de tu centro respetan la privacidad y las decisiones que tomas?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øLos profesionales de tu centro respetan la privacidad y las decisiones que tomas?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P16 -->
    <section class="question" data-question-id="q16">
        <div class="pictos">
            <img src="img/16.a.png" alt="Profesional apoyando a persona">
            <img src="img/16.b.png" alt="Grupo dentro de un c√≠rculo de seguridad">
            <img src="img/16.c.png" alt="Persona protegida">
            <img src="img/16.d.png" alt="Persona con miedo">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">16.</span>
                <span class="q-text">¬øTe sientes seguro o segura en el centro?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe sientes seguro o segura en el centro?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P17 -->
    <section class="question" data-question-id="q17">
        <div class="pictos">
            <img src="img/17.a.png" alt="Conversaci√≥n en el centro">
            <img src="img/17.b.png" alt="D√≠a en el centro">
            <img src="img/17.c.png" alt="Persona descansando en sill√≥n">
            <img src="img/17.d.png" alt="Centro con distintas actividades">
        </div>
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">17.</span>
                <span class="q-text">¬øTe gusta estar en el centro?</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="¬øTe gusta estar en el centro?">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="options">
            <button type="button" class="face-option no" data-value="NO">
                <span class="face-circle">‚òπÔ∏è</span>
                <span class="face-label">NO</span>
            </button>
            <button type="button" class="face-option sometimes" data-value="A VECES">
                <span class="face-circle">üòê</span>
                <span class="face-label">A VECES</span>
            </button>
            <button type="button" class="face-option yes" data-value="S√ç">
                <span class="face-circle">üòä</span>
                <span class="face-label">S√ç</span>
            </button>
        </div>
    </section>

    <!-- P18 ‚Äì selecci√≥n m√∫ltiple -->
    <section class="question" data-question-id="q18">
        <div class="question-header">
            <p class="question-text">
                <span class="q-number">18.</span>
                <span class="q-text">Se√±ala 3 cosas que mejorar√≠as en el centro.</span>
            </p>
            <button type="button" class="audio-btn"
                    data-question="Se√±ala tres cosas que mejorar√≠as en el centro.">
                <span class="icon">üîä</span> Escuchar
            </button>
        </div>
        <div class="multi-options">
            <button type="button" class="multi-option" data-label="Compa√±eros">
                <img src="img/18.a.png" alt="Compa√±eros">
                <span class="multi-label">COMPA√ëEROS</span>
            </button>
            <button type="button" class="multi-option" data-label="Trabajadores">
                <img src="img/18.b.png" alt="Trabajadores">
                <span class="multi-label">TRABAJADORES</span>
            </button>
            <button type="button" class="multi-option" data-label="Espacios y muebles">
                <img src="img/18.c.png" alt="Espacios y muebles">
                <span class="multi-label">ESPACIOS Y MUEBLES</span>
            </button>
            <button type="button" class="multi-option" data-label="Comidas">
                <img src="img/18.d.png" alt="Comidas">
                <span class="multi-label">COMIDAS</span>
            </button>
            <button type="button" class="multi-option" data-label="Actividades">
                <img src="img/18.e.png" alt="Actividades">
                <span class="multi-label">ACTIVIDADES</span>
            </button>
            <button type="button" class="multi-option" data-label="Transporte">
                <img src="img/18.f.png" alt="Transporte">
                <span class="multi-label">TRANSPORTE</span>
            </button>
            <button type="button" class="multi-option" data-label="Cuidados">
                <img src="img/18.g.png" alt="Cuidados">
                <span class="multi-label">CUIDADOS</span>
            </button>
        </div>
        <p class="help-text">Debes elegir exactamente <strong>3 opciones</strong>.</p>
    </section>

    <!-- BOTONES DESCARGA -->
    <div class="download-buttons">
        <button type="button" class="download-btn pdf" onclick="downloadPDF()">
            Descargar encuesta en PDF
        </button>
        <button type="button" class="download-btn csv" onclick="downloadCSV()">
            Descargar Excel
        </button>
    </div>
</main>

<script>
    const responses = {};
    let audioTimeout = null;

    // Caritas (respuestas √∫nicas)
    document.querySelectorAll('.face-option').forEach(btn => {
        btn.addEventListener('click', () => {
            const question = btn.closest('.question');
            const qId = question.dataset.questionId;

            question.querySelectorAll('.face-option').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');

            responses[qId] = btn.dataset.value;
        });
    });

    // Pregunta 18 ‚Äì selecci√≥n m√∫ltiple (exactamente 3)
    document.querySelectorAll('.multi-option').forEach(btn => {
        btn.addEventListener('click', () => {
            const question = btn.closest('.question');
            const qId = question.dataset.questionId;

            let current = responses[qId] || [];
            if (!Array.isArray(current)) current = [];

            const alreadySelected = btn.classList.contains('selected');

            if (alreadySelected) {
                btn.classList.remove('selected');
                current = current.filter(label => label !== btn.dataset.label);
            } else {
                const selectedCount = question.querySelectorAll('.multi-option.selected').length;
                if (selectedCount >= 3) {
                    alert('Solo puedes elegir 3 cosas que mejorar√≠as en el centro.');
                    return;
                }
                btn.classList.add('selected');
                current.push(btn.dataset.label);
            }

            responses[qId] = current;
        });
    });

    // Botones de audio
    function speakQuestion(text) {
        if (!('speechSynthesis' in window)) {
            alert('Lo siento, tu navegador no permite la lectura en voz alta.');
            return;
        }

        window.speechSynthesis.cancel();
        if (audioTimeout) {
            clearTimeout(audioTimeout);
            audioTimeout = null;
        }

        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'es-ES';
        utterance.rate = 0.9;
        utterance.pitch = 1.0;

        // 3 segundos de espera para no comerse el inicio
        audioTimeout = setTimeout(() => {
            window.speechSynthesis.speak(utterance);
        }, 3000);
    }

    document.querySelectorAll('.audio-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const text = btn.dataset.question || '';
            speakQuestion(text);
        });
    });

    // Comprobar si faltan preguntas por responder
    function hasUnansweredQuestions() {
        const questionSections = document.querySelectorAll('.question');
        for (const q of questionSections) {
            const qId = q.dataset.questionId;

            if (qId !== 'q18') {
                const selected = q.querySelector('.face-option.selected');
                if (!selected) {
                    return true;
                }
            } else {
                const selectedMulti = q.querySelectorAll('.multi-option.selected');
                if (selectedMulti.length !== 3) {
                    return true;
                }
            }
        }
        return false;
    }

    // Descargar Excel (CSV)
    function downloadCSV() {
        if (hasUnansweredQuestions()) {
            alert('‚ö†Ô∏è Te faltan preguntas por responder.');
            return;
        }

        const centro = document.getElementById('campo-centro').value || '';
        const fecha = document.getElementById('campo-fecha').value || '';
        const codigo = document.getElementById('campo-codigo').value || '';
        const antAnos = document.getElementById('campo-antig-anios').value || '';
        const antMeses = document.getElementById('campo-antig-meses').value || '';
        const profesional = document.getElementById('campo-profesional').value || '';

        const questions = Array.from(document.querySelectorAll('.question'));
        const headers = [
            'Centro',
            'Fecha',
            'C√≥digo persona usuaria',
            'A√±os en el centro',
            'Meses en el centro',
            'Profesional de apoyo'
        ];
        const values = [centro, fecha, codigo, antAnos, antMeses, profesional];

        questions.forEach((q, index) => {
            const qId = q.dataset.questionId;
            const num = index + 1;
            headers.push('P' + num);

            let ans = '';
            if (qId === 'q18') {
                const arr = responses[qId] || [];
                ans = Array.isArray(arr) ? arr.join(' | ') : '';
            } else {
                ans = responses[qId] || '';
            }
            values.push(ans);
        });

        const csvHeader = headers.join(';');
        const csvRow = values.map(v =>
            '"' + String(v).replace(/"/g, '""') + '"'
        ).join(';');

        const csvContent = csvHeader + '\n' + csvRow;

        const blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'encuesta_apascovi_excel.csv';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Descargar / imprimir encuesta en PDF
    function downloadPDF() {
        if (hasUnansweredQuestions()) {
            alert('‚ö†Ô∏è Te faltan preguntas por responder.');
            return;
        }
        // Igual que en la otra encuesta que s√≠ te funcionaba:
        window.print();
    }
</script>
</body>
</html>